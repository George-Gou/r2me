# 概述

!!! abstract "导言"

    本章主要介绍计量工作中最重要的部分-测量不确定度评定。     

## 什么是测量不确定度？

任何测量都不是完美的，无法测出真值，只能说高标准的计量器具其测量的不确定度更小，其测量结果的复现性也就最好。因此，我们需要对测量结果进行不确定度评价。  

说白了，测量不确定度评价就是告诉别人，我们此次测量结果的分散性，即测量结果大概的分布情况，一般可以用标准偏差来表示。

## 基础知识

本节罗列评价测量不确定度需要的一些概率论知识。这里需要掌握几个常见概率分布的标准偏差。

| 概率分布 |       标准偏差$\sigma$       |      包含因子k(p=100%)      |
| :------: | :--------------------------: | :-------------------------: |
|   均匀   |         $a/\sqrt{3}$         |         $\sqrt{3}$          |
|   三角   |         $a/\sqrt{6}$         |         $\sqrt{6}$          |
|   梯形   | $a\sqrt{1+\beta^2}/\sqrt{6}$ | $\sqrt{6}/\sqrt{1+\beta^2}$ |
|  反正弦  |         $a/\sqrt{2}$         |         $\sqrt{2}$          |

## 用GUM法评定测量不确定度

GUM法是评定测量不确定度的经典方法。其主要步骤主要有7个：  

1、明确被测量，必要时给出被测量的定义；  

2、分析不确定度来源并写出测量模型；  

3、评定测量模型中各输入量的标准不确定度$u(x_i)$，计算灵敏系数$c_i$，从而给出与各输入量相对应的输出量y的不确定度分量$u_c(y)=|c_i|u(x_i)$;  

4、计算合成标准不确定度$u_c(y)$，注意各输入量之间有没有之间相关性，必要时考虑高阶项；  

5、列出不确定度分量的汇总表，尽量给出每个不确定度分量的详细信息；  

6、对被测量的概率分布进行估计，并根据概率分布和所要包含的概率确定包含因子 $k$，无法确定被测量y的概率分布时，一般取k=2；  

7、由合成标准不确定度$u_c(y)$和包含因子，计算扩展不确定度$U_p$；  

### 分析测量不确定度的来源

对引起被测量不确定的来源需要由工程师逐一分析，包括测量仪器、测量环境、测量方法等方面都会产生测量不确定度。  实际操作中可以从以下几个方面来考虑：  

（1）测量仪器计量性能带来的不确定度：测量仪器的示值误差、分辨力等计量性能会对被测量产生影响，这需要着重考虑；  

（2）测量标准的不确定度；检定或校准用到的高一级的计量标准，这也是有不确定度的；  

（3）测量重复性：多次测量得到的一系列分散的数据，这是诸多随机误差造成的；  

（4）测量环境：如温度、湿度对长度测量有较大影响，其带来的不确定度需要考虑；  

（5）被测量的定义不完整：对被测量的定义需准确、无歧义，例如不同温度、压力得到的测量结果是不一致的，定义要给出在什么环境下、什么姿态下进行测量；  

（6）复现被测量的测量方法不理想：可能存在这种情况，例如微波测量中“衰减”量实在匹配条件下定义的，但实际测量系统不可能理想匹配，这会带来不确定度；  

（7）取样代表性不够；选取那一块区域进行测量可能得到的结果不一致。  

### 建立测量方程

分析出来各不确定来源之后，可以将其作为输入量$X_1,X_2,...,X_n$，探讨其对被测量$Y$的影响。  

用$f$表示测量函数，有$$Y=f(X_1,X_2...,X_n)$$设$y$为$Y$的估计值，各输入量的估计值为$x_i$，则有$$y=f(x_1,x_2,...x_n)$$输入量可以是直接测量的量，可以是之前测量的量，也可以来自手册或其他资料。

### 输入量的标准不确定度评定

标准不确定度评定分为 A 类和 B 类，A 类主要是利用实验数据的标准偏差来获取的，B 类评定则是利用一切有关资料进行科学判断，从而估计到的标准偏差，资料可能来源于校准证书、论文、说明书等。

#### A类不确定度评定

对于被测量 X，在同一条件下进行 b 次独立重复观测，观测值为$x_1,x_2,...x_n$，得到其算术平均值$\bar x$与实验标准偏差$s(x)$，当用算术平均值$\bar x$作为最佳估计值后，被测量估计值的重复性引入的标准不确定度$u(\bar x)$为：$$u(\bar x) = s(\bar x)=\frac{s(x)}{\sqrt(n)}$$。   

有没有可能我们做的一次重复性实验不具备代表性呢？需要核查吗？你觉得有必要就可以进行核查，假设我们核查了 m 次，则此时我们可以对 $s(x)$做一个重复性，于是有$$x_p=(sqrt(\sum_{1}^{m}s^2_j/m))$$，则标准不确定度$$u = s_p / \sqrt(n')$$ $n'$为获得平均值时的测量次数（实测情况下，上述m次是做核查实验）。

!!! note "规范化的常规测量？"
      如果我们测量 m 个同类被测量，得到 m 组数据，每组测量 n 次，此时合并样本标准偏差$x_p$为$$s_p = \sqrt{\frac{\sum_{j=1}^{m}\sum_{i=1}^{n}(x_{ij}-\bar{x_j})}{m(n-1)}}$$其中 $x_j$为第 j 组的平均值，每个被测件最佳估计值$x_j$的标准不确定度为$$u(\bar{x_j}) = s_p/\sqrt(n)$$

#### B类不确定度评定
B 类不确定评定的主要步骤：  
1、根据有关信息和经验，得到被测量值的可能区间$[\bar{x}-a, \bar{x} + a]$；  

2、假设被测量在区间内的概率分布；  

3、根据概率分布和要求的包含概率估计包含因子 k，则 B 类评定的标准不确定度 u 为：$$u=\frac{a}{k}$$其中a为被测量可能值区间的半宽度；k为包含因子；

a 的数据可能来源于说明书、校准证书、论文等渠道。被测量的概率分布模型如何确定呢？一般情况下，被测量的可能值落在区间外的概率几乎为 0 ，则当其值落在区间内的概率相同时，可设为**均匀分布**。如果其落在中间的可能性更大，可设为**三角分布**，如果其落在上下限处的可能性最大，那么可设为**反正弦函数**，如果对其分布情况缺乏了解时，设为均匀分布。实际工作中可参考历史经验来确定概率模型，如量块中心长度偏差导致的概率分布为**两点分布**。  

k 值如何确定呢，其一可以根据扩展不确定度除以标准不确定度来得到，二是查概率分布的表得到。如正态分布 95% 为 k = 2，99% 为 k = 2.58。

#### 合成标准不确定度计算

求出个各输入量的标准不确定度后，我们要用不确定度传播率将输入量的影响传递到输出量Y上。$$u_c(y) = \sqrt{\sum_{i=1}^N(\frac{\partial f}{\partial x_i})^2 u^2(x_i) + 2\sum_{i=1}^{N-1} \sum_{j=i+1}^{N} \frac{\partial f}{\partial x_i} \frac{\partial f}{\partial x_j} r(x_i,x_j) u(x_i)u(x_j)}$$

$\frac{\partial f}{\partial x_i}$为输入量$x_i$的灵敏度，$r(x_i,x_j) u(x_i)u(x_j)$为两个输入量的协方差。

!!! note "灵敏系数"
      灵敏系数其实就是测量函数 $f$，在$X_i = x$处的偏导数，是一个有符号有量值的量，它表明了输入量$x_i$的不确定度$u(x_i)$对输出量 $u_c(y)$ 的灵敏程度。

当各输入量不相关时，可以简化为$$u_c(y) = \sqrt{\sum_{i=1}^N(\frac{\partial f}{\partial x_i})^2 u^2(x_i)}$$

### 输入量相关的处理方法

1、一般来说，对于独立测量，不同的量之间测量结果可以忽略相关性；不同实验室、不同时间、不同设备测量同一个量，也可以假设相关性为零；当$x_i,x_j$中任意一个量可以当作常数处理事，就可以忽略。  

2、不能忽略的话，可以估计一下**协方差参考值**；对两个输入量$X_i,X_j$同时进行重复观测，设$x_{ik},x_{jk}$分别是输入量$X_i,x_j$的观测值。$k$为测量序号，$\bar{x_i},\bar{x_j}$分别是第$i$和第$j$个输入量的n次测量的算术平均值；则可用下式对协方差值进行估计：$$u(x_i,x_j)=\frac{1}{n-1}\sum_{k=1}^{n}(x_{ik}-\bar{x_i}(x_{ij}-\bar{x_j}))$$当协方差足够小时（其绝对值远远小于输入量标准偏差的乘积，则可以认为这两个输入量无关）。  

注意，如果是平均值的话，还要除以一个 n ，即$$u(x_i,x_j)=\frac{1}{n(n-1)}\sum_{k=1}^{n}(x_{ik}-\bar{x_i}(x_{ij}-\bar{x_j}))$$

3、**关于相关系数的计算**：$$r(x,y)  = \frac{\sum_{i=1}^{n}(x_i-\bar{x})(y_i-\bar{y})}{(n-1)s(x)x(y)}$$也可以用经验公式估计相关系数：$$r(x_i,x_j)*\approx*\frac{u(x_i)\delta_j}{x(x_j)\delta_i}$$，其中$\delta$表示输入量的变化量。 

4、想办法消除相关性：（1）变换输入量，让两者不具有相关性，比如用高等别量块校准低等别量块的时候，两个量块的温度具有一定相关性，将标准量块的温度$\delta_s$和两者之差$\delta$作为输入量则两者相关性就显著减小了；（2）如果输入量都与同一个变量有关系，比如$f(x_i,x_j)$中的$x_i,x_j$都与温度有关系，则可以将温度T也加入测量模型$f(x_i,x_j,T)$，这样两者就没有相关性了，但都与T有相关性；  

### 有效自由度

什么是自由度？自由度是指计算某一统计量时，取值不受限制的变量个数，通常为方程个数减去未知数个数。一般来说自由度越高，得到的未知数解越准确。  

有效自由度的计算公式为：$$v_{eff} = \frac{u_c^4(y)}{\sum_{i=1}^{N}\frac{u_i^4(y)}{v_i}}$$当然，也可以方便地推出相对标准不确定度度的有效自由度表达式：$$v_{eff} = \frac{u_c^4(y)/y}{\sum_{i=1}^{N}\frac{[P_iu(x_i)/x_i]^4}{v_i}}$$此时的测量模型为$$Y=AX_1^{P1}X_2^{P2}X_3^{P3}...X_N^{P_N}$$标准不确定度的自由度为$v_i$，其可以通过公式$$v_i \approx \frac{1}{2}\ \frac{\Delta u(x_i)}{u(x_i)}$$来估计其自由度。

### 扩展不确定度

扩展不确定度是在合成标准不确定度的基础上再扩展，此举放大了不确定度，也是对测量结果的保守估计。$$U=ku_c$$一般来说选取k=2或者3，k=2时包含概率大约为 95%，k=3时包含概率大约为 99%，即测量值包含在$[y-U \leq Y \leq y+U]$, y是被测量Y的最佳估计值。给出扩展不确定度的同时，一定要给出k值。

第二种情况：**明确规定包含概率$p$**，这时候就要定量求出$k_p$，$$U = k_pu_c$$。那怎么计算$k_p$呢？一般来说当输出满足小样本的正态分布（t分布）时，可以取$$k_p=t_p(v_{eff})$$，根据其有效自由度，查表可以得到$k_p$。

!!! note "不确定度表达上要注意的点"
      1、无论如何，扩展不确定度一定要注明 k 等于多少  
      2、不确定度不需要 +-号  
      

## 蒙特卡洛法评定测量不确定度

传统的 GUM 法是根据输入量的标准不确定来合成输出量的标准不确定度的，这是基于测量模型基本线性的基础上，当测量模型非线性的时候，需要考虑对其进行展开来达到线性化的效果。  

蒙特卡洛（Monte-Carlo Method，MCM）的核心思想是不管多复杂的测量模型，我只需要知道输入量的概率密度函数，来随机生成一个样本空间，经过测量模型，来得到一系列的输出值，最终由多个输出值的概率分布，得到输出量的最佳估计值、标准不确定度和包含区间。  

MCM方法主要分为四个步骤：1）MCM输入：写出测量模型，给出输入量的概率分布（PDF）；2）MCM传播：根据随机抽样出的样本值，计算响应的模型值；3）MCM输出：根据模型输出值，得到输出量Y的分布函数

### MCM 评定不确定度具体步骤

1）建立测量模型  

和 GUM 方法一样，先根据测量原理建立测量模型 。

2）对每个输入量设定 PDF  

根据经验、说明书、测量结果设定每个输入量的分布，可以是均匀分布、高斯分布、矩形分布等等。  

3）选定蒙特卡洛试验数  

合理选择样本量的大小，一般来说越大结果越准确，但也增加了计算量。于是我们一般选取 $M=10^6$，会为输出量提供超 95% 的包含区间。无法保证 M 个数是否够，可以使用自适应的MCM方法，即依次增大 M 的量级，来根据结果判断。  

4）输入量概率分布的抽样即模型值计算  

根据各输入量的 PDF 抽样出一批值来，根据测量模型，得到输出量的模型值。  

5）输出量分布函数的离散表示  

再得到一系列的输出值后，对该量值进行排序，再划定直方图，得到每个区间的概率分布，这样就离散化地表示了输出量的PDF。  

6）得到结果  

即输出量的估计值、标准不确定度及包含区间。  

模型估计值为样本值的算术平均值，即$$\bar y = \frac{1}{M}]\sum_{r=1}^{M}y_r$$

被测量估计值 y 的标准不确定度u(y)为算术平均值$\bar y$的标准偏差$u(\bar y)$可有下式计算：  $$u(\bar{y})=\sqrt{\frac{1}{M-1}\sum_{r=1}^{M}(y_r-\bar y)^2}$$

对于输出量的包含区间可以用 **包含概率与实验数M的乘积 pM来表示**。

## GUM 和 MCM 法的比较

通过前面的介绍大家应该有这样一种感觉，GUM 法是通过**不确定度传播率**来确定输出量的合成标准不确定度的，即计算输出量相对每个输入量的偏导数得到灵敏系数，再对每一分量进行求和累加再开根号的结果。而 MCM 方法是通过**概率分布来传播**的，并在次基础上给出被测量的估计值、标准不确定度和包含区间。  

两种方法孰优孰劣，这在不同的应用场景中有所不同。比如说当测量模型简单、呈线性、输入量的分布呈对称分布、输出量的分布为正态分布。而 MCM 适用于非线性模型，即灵敏系数的求取非常复杂的情况，且输出量呈现明显的**非对称分布**。  

相较而言 MCM 法更加具有普适性，因此可以用 MCM 法对 GUM 法评定的结果进行检验。  

假设应用 GUM 法得到输出量的包含概率为p 的包含区间为 $y \pm U_p$；运用 MCM 获得输出量的标准不确定度$u(y)$和概率为 p 的对称包含区间端点值为$y_{low}、y_{high}$。  

数值容差$\delta$ 为不确定度有效位数最后一位数字的一半，如果$$d_{low} = |(y-U_p)-y_{low}|,且d_{high}=|(y+U_p)-y_{high}|$$当$d_{low}$和$d_{high}$都小于$\delta$时认为 GUM 法适用于该测量的不确定度评定。  

## 常用的误差来源评定方法

### 分辨力

如果数字显示仪器的分辨力为$\delta_x$，则区间半宽度为$a=\delta_x/2$，则可设为均匀分布，查表$k=\sqrt{3}$，则由分辨力引入的标准不确定度分量：$$u(x)=\frac{a}{k}$$

## 如何判断误差属于什么分布

根据 JJF 1059.1-2012《测量不确定度评定与表示》 的4.3.3.4：  

1、由数据修约、测量仪器最大允许误差或分辨力、参考数据的误差限、度盘或齿轮的回差、平衡指示器调零不准、测量仪器的滞后或摩擦效应导致的不确定度，通常假设为**均匀分布**；

2、两相同均匀分布的合成、两个独立量之和或差值服从**三角分布**，如果是两个不同大小的均匀分布合成，则可假设为**梯形分布**；  

3、度盘偏心引入的测角不确定度、正弦振动引入的位移不确定度、无线电测量中失配引入的不确定度、随时间正弦或余弦变化的温度不确定度，一般假设为反正弦分布( 即 **U 型分布**)；  

4、按级使用量块（除 00 级以外），中心长度偏差的概率分布可假设为**两点分布**。

## 引用来源 {#references .no-underline}
<div id="refer-anchor"></div>
 [1]《一级注册计量师基础知识及专业实务》  
